[13:03:14] INFO Created directory structure: /Users/gadmohamed/Desktop/LMS/aiagent/data and /Users/gadmohamed/Desktop/LMS/aiagent/data/references
[13:03:16] INFO Testing against: https://lms-swart-five.vercel.app (VERCEL)
[13:03:16] INFO [test_server_health] Testing server health
[13:03:16] INFO [test_server_health] Profile endpoint response: 401, {"detail":"Not authenticated"}
[13:03:16] INFO [test_server_health] Root endpoint response: 200, {"message":"LMS API is running"}
[13:03:16] INFO [test_server_health] Server is responding to requests
[13:03:16] INFO [test_upload_file] START
[13:03:16] INFO [registerUser] Registering user: None
[13:03:16] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_050bbb8a', 'password': 'testpass123'}
[13:03:17] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":870}
[13:03:17] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 870}
[13:03:17] INFO [loginUser] Logging in user: {'username': 'testuser_050bbb8a', 'password': 'testpass123'}
[13:03:18] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl8wNTBiYmI4YSIsImV4cCI6MTc0NjkwMDE5OH0.PBMnb7A2WUVK-jQAdzmEWzv0HR_NQbFahjQZrcf8VbQ', 'token_type': 'bearer'}
[13:03:18] INFO [test_upload_file] Uploading file: testfile.txt
[13:03:18] INFO [test_upload_file] Response status: 200, body: {'filename': 'testfile.txt', 'size': 11, 'fileId': 434, 'content_type': 'text/plain', 'version': 1, 'uploaded_at': '2025-05-10T17:03:18.877565'}
[13:03:18] INFO [test_upload_file] END
[13:03:18] INFO [test_active_url_success] START
[13:03:18] INFO [test_active_url_success] Payload: {'url': 'https://example.com', 'title': 'Example Page'}
[13:03:19] INFO [test_active_url_success] Response status: 200, body: {'data': {'status': 'success'}}
[13:03:19] INFO [test_active_url_success] END
[13:03:19] INFO [test_active_url_missing_url] START
[13:03:19] INFO [test_active_url_missing_url] Payload: {'title': 'Example Page'}
[13:03:19] INFO [test_active_url_missing_url] Response status: 400, body: {'error': 'Missing URL'}
[13:03:19] INFO [test_active_url_missing_url] END
[13:03:19] INFO [test_profile] START
[13:03:19] INFO [registerUser] Registering user: None
[13:03:19] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_ffff4877', 'password': 'testpass123'}
[13:03:20] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":871}
[13:03:20] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 871}
[13:03:20] INFO [loginUser] Logging in user: {'username': 'testuser_ffff4877', 'password': 'testpass123'}
[13:03:21] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl9mZmZmNDg3NyIsImV4cCI6MTc0NjkwMDIwMX0.yipVWawnofqke63TUO6GPEpZAImQ5o71PcaP1JFmdmM', 'token_type': 'bearer'}
[13:03:21] INFO [test_profile] Response status: 200, body: {'userId': 871, 'username': 'testuser_ffff4877', 'max_file_size': 524288000, 'role': 0}
[13:03:21] INFO [test_profile] Cleanup delete response for testuser_ffff4877: 200
[13:03:21] INFO [test_profile] END
[13:03:21] INFO [testQueryEndpoint] START
[13:03:21] INFO [registerUser] Registering user: None
[13:03:21] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_cb51ca2f', 'password': 'testpass123'}
[13:03:22] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":872}
[13:03:22] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 872}
[13:03:22] INFO [loginUser] Logging in user: {'username': 'testuser_cb51ca2f', 'password': 'testpass123'}
[13:03:23] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl9jYjUxY2EyZiIsImV4cCI6MTc0NjkwMDIwM30.kHGucK3e9fmrbKIjL6TfREwAPp3CQOHQHfP1z4BUAEA', 'token_type': 'bearer'}
[13:03:23] INFO [testQueryEndpoint] Case 1: Missing JSON body
[13:03:23] INFO [testQueryEndpoint] Case 1 Response: 400, {"error":"Empty request body"}
[13:03:23] INFO [testQueryEndpoint] Case 2: Missing 'query' field
[13:03:23] INFO [testQueryEndpoint] Case 2 Response: 400, {"error":"No query provided"}
[13:03:23] INFO [testQueryEndpoint] Case 3: Missing 'chatId' field
[13:03:24] INFO [testQueryEndpoint] Case 3 Response: 400, {"error":"No chat ID provided"}
[13:03:24] INFO [testQueryEndpoint] Case 4: Valid request
[13:03:26] INFO [testQueryEndpoint] Case 4 Response: 200, {"response":"Thank you for providing your new phone number. If you need any assistance with updating it on any platforms or accounts, feel free to let me know. How can I assist you further today?","query":"I have changed my phone number to 807-555-5555\n\nHere is the page content: Some content","chat_id":"chat1","queryId":69}
[13:03:26] INFO [testQueryEndpoint] END
[13:03:26] INFO [test_delete_user] START
[13:03:26] INFO [test_delete_user] Registering user: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:26] INFO [registerUser] Registering user: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:26] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:27] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":873}
[13:03:27] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 873}
[13:03:27] INFO [loginUser] Logging in user: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:28] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl8wMjY4ODA4OCIsImV4cCI6MTc0NjkwMDIwOH0.QJdErkUzYviBUEkSGX2vb6agg99tRwr-rXlcZ1Gjhck', 'token_type': 'bearer'}
[13:03:28] INFO [test_delete_user] Deleting user testuser_02688088 (self-delete)
[13:03:29] INFO [test_delete_user] Delete response: 200, {"message":"User 'testuser_02688088' deleted successfully."}
[13:03:29] INFO [test_delete_user] Try deleting user testuser_02688088 again (should be not found/unauthorized)
[13:03:29] INFO [test_delete_user] Second delete response: 401, {"detail":"Invalid credentials"}
[13:03:29] INFO [test_delete_user] Re-registering user testuser_02688088
[13:03:29] INFO [registerUser] Registering user: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:29] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_02688088', 'password': 'testpass123'}
[13:03:30] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":874}
[13:03:30] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 874}
[13:03:30] INFO [test_delete_user] Registering second user: {'username': 'testuser_481390ee', 'password': 'testpass123'}
[13:03:30] INFO [registerUser] Registering user: {'username': 'testuser_481390ee', 'password': 'testpass123'}
[13:03:30] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_481390ee', 'password': 'testpass123'}
[13:03:31] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":875}
[13:03:31] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 875}
[13:03:31] INFO [loginUser] Logging in user: {'username': 'testuser_481390ee', 'password': 'testpass123'}
[13:03:32] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl80ODEzOTBlZSIsImV4cCI6MTc0NjkwMDIxMn0.gg7nSO5GCAjClNuvJZhUGJ7MhxdDwCR7ai0_gJoaEwA', 'token_type': 'bearer'}
[13:03:32] INFO [test_delete_user] Second user attempts to delete testuser_02688088
[13:03:32] INFO [test_delete_user] Forbidden delete response: 403, {"detail":"You can only delete your own account."}
[13:03:32] INFO [test_delete_user] END
[13:03:32] INFO [test_list_files] START
[13:03:32] INFO [registerUser] Registering user: None
[13:03:32] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_ac867881', 'password': 'testpass123'}
[13:03:33] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":876}
[13:03:33] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 876}
[13:03:33] INFO [loginUser] Logging in user: {'username': 'testuser_ac867881', 'password': 'testpass123'}
[13:03:33] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl9hYzg2Nzg4MSIsImV4cCI6MTc0NjkwMDIxNH0.6G7YchxrOtDB-ata2ym4zI3RKjGLQPNsALzruXbWzQo', 'token_type': 'bearer'}
[13:03:33] INFO [test_list_files] Listing files
[13:03:34] INFO [test_list_files] Response status: 200, body: {'files': [{'fileId': 445, 'filename': 'short_term_memory.json', 'size': 39, 'uploaded_at': '2025-05-10T17:03:33.287189'}, {'fileId': 446, 'filename': 'long_term_memory.json', 'size': 279, 'uploaded_at': '2025-05-10T17:03:33.287195'}], 'count': 2}
[13:03:34] INFO [test_list_files] END
[13:03:34] INFO [test_download_file] START
[13:03:34] INFO [registerUser] Registering user: None
[13:03:34] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_d2d9436c', 'password': 'testpass123'}
[13:03:35] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":877}
[13:03:35] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 877}
[13:03:35] INFO [loginUser] Logging in user: {'username': 'testuser_d2d9436c', 'password': 'testpass123'}
[13:03:35] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl9kMmQ5NDM2YyIsImV4cCI6MTc0NjkwMDIxNn0.X37uib5XFrqBkTUmcrhaYG-bdVaX3MOQlGpPIHvd-q4', 'token_type': 'bearer'}
[13:03:35] INFO [test_download_file] Uploading file: testfile.txt
[13:03:36] INFO [test_download_file] Upload response: {'filename': 'testfile.txt', 'size': 11, 'fileId': 449, 'content_type': 'text/plain', 'version': 1, 'uploaded_at': '2025-05-10T17:03:36.375044'}
[13:03:36] INFO [test_download_file] Downloading file with ID: 449
[13:03:36] INFO [test_download_file] Response status: 200, length: 11
[13:03:36] INFO [test_download_file] END
[13:03:36] INFO [test_delete_file] START
[13:03:36] INFO [registerUser] Registering user: None
[13:03:36] INFO [registerUser] Sending request to https://lms-swart-five.vercel.app/register with user data: {'username': 'testuser_2deed560', 'password': 'testpass123'}
[13:03:37] INFO [registerUser] Response status: 200, raw response: {"message":"Registered successfully","userId":878}
[13:03:37] INFO [registerUser] JSON response: {'message': 'Registered successfully', 'userId': 878}
[13:03:37] INFO [loginUser] Logging in user: {'username': 'testuser_2deed560', 'password': 'testpass123'}
[13:03:38] INFO [loginUser] Response status: 200, body: {'access_token': 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlcl8yZGVlZDU2MCIsImV4cCI6MTc0NjkwMDIxOH0.knuuKAc4V-NoKau1rC3pV5DHER7SLW481CCIHC8dgFI', 'token_type': 'bearer'}
[13:03:38] INFO [test_delete_file] Uploading file: testfile.txt
[13:03:38] INFO [test_delete_file] Upload response: {'filename': 'testfile.txt', 'size': 11, 'fileId': 452, 'content_type': 'text/plain', 'version': 1, 'uploaded_at': '2025-05-10T17:03:38.917655'}
[13:03:38] INFO [test_delete_file] Deleting file with ID: 452
[13:03:38] INFO [test_delete_file] Delete response: 200, {'message': "File 'testfile.txt' deleted successfully.", 'fileId': 452}
[13:03:39] INFO [test_delete_file] File list after delete: {'detail': 'Invalid credentials'}
[13:03:39] INFO [test_delete_file] END
